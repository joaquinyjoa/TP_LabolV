<!-- Spinner global para navegaciÃ³n -->
<div class="overlay" *ngIf="loading">
  <mat-spinner diameter="50"></mat-spinner>
</div>

<nav class="navbar">
  <div class="nav-left">
    <span class="logo">ğŸ¯ Mi App</span>
  </div>

  <div class="nav-right">
    <a (click)="NavegarQuienSoy()" class="nav-link">QuiÃ©n soy</a>
    <a (click)="NavegarJuegos()" class="nav-link">ğŸ® Juegos</a>
    <a (click)="navegarListados()" class="nav-link">ğŸ“‹ Listados</a>

    <ng-container *ngIf="user$ | async as user">
      <span class="nav-link user-nick">ğŸ‘¤ {{ user.nick }}</span>
      <button class="btn btn-logout" (click)="logout()">Cerrar sesiÃ³n</button>
    </ng-container>
  </div>
</nav>

<div class="home-container" *ngIf="user$ | async as user">
  <p class="welcome">Bienvenido <b>{{ user.nick }}</b>!</p>

  <div class="pais-info" *ngIf="user.pais && user.paisFlag">
    <img [src]="user.paisFlag" alt="Bandera de {{ user.pais }}" class="bandera" />
    <span>{{ user.pais }}</span>
  </div>

  <p class="fecha">
    ğŸ“… Registrado el: {{ user.fechaRegistro?.toDate() | date:'dd/MM/yyyy HH:mm' }}
  </p>

  <!-- Chat en tiempo real -->
  <div class="chat-container">
    <h3>Chat en tiempo real</h3>

    <div class="chat-box">
      <div *ngIf="loadingChat" class="spinner-container">
        <p>ğŸ”„ Cargando mensajes...</p>
      </div>

      <div *ngFor="let msg of chatMessages$ | async" class="chat-message">
        <b>{{ msg.user }}</b> [{{ msg.time | date:'HH:mm:ss' }}]: {{ msg.message }}
      </div>
    </div>

    <div class="chat-input">
      <input [(ngModel)]="newMessage" placeholder="EscribÃ­ tu mensaje..." (keydown.enter)="enviarMensaje(user)"  />
      <button (click)="enviarMensaje(user)">Enviar</button>
    </div>
  </div>
</div>
